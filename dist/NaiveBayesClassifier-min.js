!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.NaiveBayesClassifier=e()}(this,function(){"use strict";var t=function(t){if(this.options={},!t){if("object"!=typeof t)throw new TypeError("NaiveBayesClassifier got invalid `options`: `"+t+"`. Please pass in an object.");this.options=t}var e=function(t){var e=new RegExp(/[^\w\s]/g),o=t.replace(e," ").toLowerCase();return o.split(/\s+/)};this.tokenizer=this.options.tokenizer||e,this.vocabulary={},this.vocabularySize=0,this.categories={},this.docFrequencyCount={},this.totalNumberOfDocuments=0,this.wordFrequencyCount={},this.wordCount={}};return t.VERSION="0.1.0",t.withClassifier=function(e){return new t(e.options)},t.prototype.addWordToVocabulary=function(t){this.vocabulary[t]||(this.vocabulary[t]=!0,this.vocabularySize+=1)},t.prototype.getVocabularySize=function(){return this.vocabularySize=Object.keys(this.vocabulary).length,this.vocabularySize},t.prototype.getOrCreateCategory=function(t){if(!t||"string"!=typeof t)throw new TypeError("Category creator got invalid category name: `"+t+"`. Please pass in a String.");return this.categories[t]||(this.docFrequencyCount[t]=0,this.wordFrequencyCount[t]={},this.wordCount[t]=0,this.categories[t]=!0),this.categories[t]?t:void 0},t.prototype.FrequencyTable=function(t){var e={};return t.forEach(function(t){e[t]?e[t]+=1:e[t]=1}),e},t.prototype.learn=function(t,e){var o=this;e=o.Category(e),o.docFrequencyCount[e]+=1,o.totalNumberOfDocuments+=1;var r=o.tokenizer(t),i=o.FrequencyTable(r);return Object.keys(i).forEach(function(t){o.addWordToVocabulary(t);var r=i[t];o.wordFrequencyCount[e][t]?o.wordFrequencyCount[e][t]+=r:o.wordFrequencyCount[e][t]=r,o.wordCount[e]+=r}),o},t.prototype.tokenProbability=function(t,e){var o=this.wordFrequencyCount[e][t]||0,r=this.wordCount[e];return(o+1)/(r+this.getVocabularySize())},t.prototype.categorize=function(t){var e=this,o=-(1/0),r=0,i={},n={},a=e.tokenizer(t),c=e.FrequencyTable(a);return Object.keys(e.categories).forEach(function(t){if(e.categories[t]){var a=e.docFrequencyCount[t]/e.totalNumberOfDocuments,u=Math.log(a);Object.keys(c).forEach(function(o){var r=e.tokenProbability(o,t);u+=Math.log(r)}),a=Math.exp(u),r+=a,u>o&&(o=u,i={category:t,probability:a}),n[t]=a}}),Object.keys(n).forEach(function(t){n[t]/=r}),{category:i.category||"unclassified",probability:(i.probability/=r)||-(1/0),categories:n}},t});